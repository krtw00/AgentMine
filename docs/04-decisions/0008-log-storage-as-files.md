---
depends_on:
  - ./0004-agentmine-home-dir.md
tags: [decisions, adr, logs, storage]
ai_summary: "ログをDBに保存せず、~/.agentmine/logsのファイルとして保存することを決定する"
---

# ADR-0008: ログはファイルとして保存する

> Status: Accepted
> 最終更新: 2026-02-01

## コンテキスト

runとcheckの出力は監査とデバッグに必要である。
一方で、ログをDBに格納するとDBが肥大化しやすい。
MVPはローカル一人運用であるため、ファイル保存の運用コストは低い。

## 決定事項

ログはAgentMine Home配下のファイルとして保存する。
DBは参照（log_ref/output_ref）を保持する。

## 検討した選択肢

### 選択肢1: DBに保存（不採用）

- 長所: 一括で検索しやすい
- 短所: DBが肥大化する。バックアップが重くなる

### 選択肢2: 保存しない（不採用）

- 長所: 実装が最小である
- 短所: 監査と再現性が成立しない

### 選択肢3: ファイルとして保存（採用）

- 長所: DB肥大化を防げる。追記が単純である
- 短所: 参照と削除の運用が必要になる

## 決定理由

- run単位で事実（ログ）を残すため
- DB正の原則を保ちつつ、ログを別ストレージに逃がすため

## 結果

### ポジティブな影響

- ログ保存のコストが低い
- DBの性能劣化を避けやすい

### ネガティブな影響

- ログの保管・削除ポリシーが必要になる

## 関連ドキュメント

- [ADR-0004](./0004-agentmine-home-dir.md) - `~/.agentmine`
- [ログ保存](../03-details/log-storage.md) - 保存場所と参照

